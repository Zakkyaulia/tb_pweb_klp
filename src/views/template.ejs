<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Template Surat - SIPAS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    function openModal(judul) {
      document.getElementById('modalJudul').innerText = judul;
      document.getElementById('modal').classList.remove('hidden');
    }

    function closeModal() {
      document.getElementById('modal').classList.add('hidden');
    }
  </script>
</head>
<body class="bg-green-800 min-h-screen p-6 text-gray-700">
  <!-- Navbar -->
  <nav class="flex justify-between items-center mb-6 text-white">
    <h1 class="text-2xl font-bold">SIPAS</h1>
    <ul class="flex space-x-6 font-semibold">
      <li><a href="/pengumuman">Pengumuman</a></li>
      <li><a href="/template" class="bg-orange-600 px-3 py-1 rounded">Template</a></li>
      <li><a href="/history">Riwayat</a></li>
      <li><a href="/petunjuk">Petunjuk</a></li>
      <li><a href="/pengajuan">Mulai</a></li>
    </ul>
  </nav>

  <!-- Main Content -->
  <main class="flex-1 bg-white p-6 rounded-lg m-6 shadow">
    <h2 class="text-2xl font-bold mb-4">Pilih Template Surat</h2>
    <div class="space-y-4">
      <% if (templates && templates.length > 0) { %>
        <% templates.forEach(template => { %>
          <div class="flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50">
            <span class="font-semibold text-gray-800"><%= template.jenis_surat %></span>
            <div class="space-x-2">
              <button onclick="openModal('<%= template.preview_file %>')" class="bg-orange-500 text-white px-4 py-1 rounded shadow hover:bg-orange-600 transition">Lihat</button>
              <a href="/template/<%= template.surat_id %>" class="bg-green-600 text-white px-4 py-1 rounded shadow hover:bg-green-700 transition">Detail</a>
            </div>
          </div>
        <% }); %>
      <% } else if (error) { %>
        <p class="text-red-500"><%= error %></p>
      <% } else { %>
        <p>Tidak ada template yang tersedia.</p>
      <% } %>
    </div>
  </main>

  <!-- Modal -->
  <div id="preview-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
    <div class="bg-white p-4 rounded-lg max-w-3xl w-full">
      <div class="flex justify-end">
        <button onclick="closeModal()" class="text-2xl font-bold">&times;</button>
      </div>
      <div class="mt-4">
        <img id="preview-image" src="" alt="Pratinjau Surat" class="w-full h-auto" />
      </div>
    </div>
  </div>

  <script>
    const modal = document.getElementById('preview-modal');
    const previewImage = document.getElementById('preview-image');

    function openModal(imageFile) {
      if (imageFile && imageFile !== 'null') {
        // Asumsikan gambar ada di /images/files/
        previewImage.src = `/images/files/${imageFile}`;
        modal.classList.remove('hidden');
      } else {
        alert('Pratinjau untuk surat ini tidak tersedia.');
      }
    }

    function closeModal() {
      modal.classList.add('hidden');
      previewImage.src = ''; // Kosongkan sumber gambar
    }
  </script>
</body>
</html>
